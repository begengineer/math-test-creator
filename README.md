# 中学生数学テスト作成システム

日本の学習指導要領に基づく中学生向け数学テスト自動生成Webアプリケーションです。

## 🎯 機能

### 🤖 **AI問題生成**
- **Claude AI搭載**: Anthropic Claude APIによる高品質な問題自動生成
- **無限バリエーション**: 重複のない無制限の問題生成
- **動的難易度調整**: AIが指定難易度に合わせて最適な問題を作成
- **自然言語処理**: 自然で理解しやすい問題文生成

### 📚 **学習指導要領対応**
- **中学1年生**: 正負の数、文字と式、方程式、比例と反比例、平面図形、空間図形、データの活用
- **中学2年生**: 式の計算、連立方程式、一次関数、図形の調べ方、平行四辺形、確率
- **中学3年生**: 式の展開と因数分解、平方根、二次方程式、関数 y=ax²、相似な図形、円、三平方の定理、標本調査

### ⚙️ **カスタマイズ機能**
- **学年選択**: 中学1〜3年生
- **分野選択**: 複数分野の組み合わせ可能
- **難易度調整**: 5段階レベル設定
- **時間設定**: 20〜90分の制限時間

### 🔐 **セキュリティ**
- パスワード認証
- JWT トークンベース認証
- セッション管理
- レート制限

## 🚀 セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 環境変数の設定

`.env.example` を `.env` にコピーして設定:

```bash
cp .env.example .env
```

**重要**: Anthropic APIキーを設定してください:

```bash
# .env ファイル内
ANTHROPIC_API_KEY=your-anthropic-api-key-here
```

APIキーは [Anthropic Console](https://console.anthropic.com/) で取得できます。

### 3. サーバー起動

```bash
npm start
```

または開発モード:

```bash
npm run dev
```

### 4. アクセス

ブラウザで `http://localhost:3000` にアクセス

## 🔐 認証情報

- **デフォルトパスワード**: `mathtest2025`
- パスワードは `auth.js` で変更可能

## 📁 ファイル構成

```
createTest/
├── login.html           # ログインページ
├── login.css            # ログインスタイル
├── login.js             # 認証ロジック
├── index.html           # メインアプリページ
├── style.css            # メインスタイル
├── app.js               # フロントエンド制御
├── server.js            # Node.jsサーバー
├── auth.js              # 認証システム
├── curriculum.js        # カリキュラムデータ
├── problemGenerator.js  # 問題生成エンジン
├── pdfGenerator.js      # PDF生成機能
├── package.json         # 依存関係
├── vercel.json          # Vercelデプロイ設定
└── README.md            # このファイル
```

## 🌐 デプロイ

### Vercel

1. GitHubリポジトリを作成してコードをプッシュ
2. [Vercel](https://vercel.com) でリポジトリを接続
3. 環境変数を設定:
   - `JWT_SECRET`: ランダムな秘密鍵
   - `NODE_ENV`: `production`

### その他のプラットフォーム

- **Railway**: GitHubリポジトリ接続で自動デプロイ
- **Render**: 無料プランでNode.jsアプリをホスト
- **Heroku**: Git pushでデプロイ

## 🛠️ 使用技術

- **フロントエンド**: HTML5, CSS3, JavaScript (ES6+)
- **バックエンド**: Node.js, Express
- **認証**: JWT, bcrypt
- **PDF生成**: jsPDF
- **セキュリティ**: Helmet.js, CORS, Rate Limiting

## 📊 使用方法

1. **ログイン**: パスワードを入力してアクセス
2. **学年選択**: 中学1〜3年生から選択
3. **分野選択**: テストに含める分野を複数選択可能
4. **設定**: 難易度(1〜5)と制限時間(20〜90分)を設定
5. **生成**: 自動的に問題を生成
6. **ダウンロード**: 問題用紙と解答用紙をPDFで出力

## 🔧 カスタマイズ

### 問題の追加・編集

`problemGenerator.js` で各分野の問題生成ロジックをカスタマイズできます。

### 難易度調整

`curriculum.js` で各分野の難易度設定と時間配分を調整できます。

### デザイン変更

`style.css` と `login.css` でUIのカスタマイズが可能です。

## 🐛 トラブルシューティング

### 認証エラー
- ブラウザのクッキーが有効か確認
- JWT_SECRET環境変数が設定されているか確認

### PDF生成エラー
- jsPDFライブラリが正しく読み込まれているか確認
- ブラウザの開発者ツールでエラーを確認

### サーバー起動エラー
- Node.jsバージョン (14.0.0以上) を確認
- ポート3000が使用可能か確認
- 依存関係が正しくインストールされているか確認

## 📝 ライセンス

MIT License

## 🤝 貢献

プルリクエストやイシューの報告を歓迎します。

---

💡 **ヒント**: パスワードを変更する場合は、`auth.js` の `generateDefaultHash()` メソッドを確認してください。